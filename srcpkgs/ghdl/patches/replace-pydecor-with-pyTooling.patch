From be9a134364bc79cf1e8e9968d50cd296a7975ecf Mon Sep 17 00:00:00 2001
From: Patrick Lehmann <Patrick.Lehmann@plc2.de>
Date: Sun, 12 Dec 2021 14:35:51 +0100
Subject: [PATCH] Changed export decorator from pydecor to pyTooling.Decorators

---
 pyGHDL/cli/lsp.py                  | 16 ++++++----------
 pyGHDL/dom/DesignUnit.py           |  2 +-
 pyGHDL/dom/InterfaceItem.py        |  2 +-
 pyGHDL/dom/Misc.py                 |  2 +-
 pyGHDL/dom/__init__.py             |  2 +-
 pyGHDL/libghdl/__init__.py         |  4 +++-
 pyGHDL/libghdl/_decorator.py       |  2 +-
 pyGHDL/libghdl/errorout.py         |  2 +-
 pyGHDL/libghdl/errorout_console.py |  2 +-
 pyGHDL/libghdl/errorout_memory.py  |  2 +-
 pyGHDL/libghdl/files_map.py        |  2 +-
 pyGHDL/libghdl/files_map_editor.py |  2 +-
 pyGHDL/libghdl/libraries.py        |  2 +-
 pyGHDL/libghdl/name_table.py       |  2 +-
 pyGHDL/libghdl/std_names.py        |  2 +-
 pyGHDL/libghdl/utils.py            |  2 +-
 pyGHDL/libghdl/vhdl/elocations.py  |  2 +-
 pyGHDL/libghdl/vhdl/flists.py      |  2 +-
 pyGHDL/libghdl/vhdl/formatters.py  |  2 +-
 pyGHDL/libghdl/vhdl/lists.py       |  2 +-
 pyGHDL/libghdl/vhdl/nodes.py       |  2 +-
 pyGHDL/libghdl/vhdl/nodes_meta.py  |  2 +-
 pyGHDL/libghdl/vhdl/nodes_utils.py |  2 +-
 pyGHDL/libghdl/vhdl/parse.py       |  2 +-
 pyGHDL/libghdl/vhdl/scanner.py     |  2 +-
 pyGHDL/libghdl/vhdl/sem.py         |  2 +-
 pyGHDL/libghdl/vhdl/sem_lib.py     |  2 +-
 pyGHDL/libghdl/vhdl/tokens.py      |  2 +-
 scripts/pnodespy.py                | 13 ++++++++-----
 29 files changed, 43 insertions(+), 42 deletions(-)

diff --git a/pyGHDL/cli/lsp.py b/pyGHDL/cli/lsp.py
index 44d55635..58da6c90 100644
--- a/pyGHDL/cli/lsp.py
+++ b/pyGHDL/cli/lsp.py
@@ -39,7 +39,7 @@ from logging import getLogger, DEBUG, INFO, ERROR, basicConfig
 import sys
 import os
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 import pyGHDL.libghdl as libghdl
 from pyGHDL.libghdl     import version, errorout_console
@@ -62,16 +62,12 @@ def __rotate_log_files(basename: str, num: int):
 
 def _generateCLIParser() -> ArgumentParser:
     """Creates an CLI argument parser based on ``argparse``."""
-    parser = ArgumentParser(description="VHDL Language Protocol Server. Find info about clients in `ghdl/ghdl-language-server <https://github.com/ghdl/ghdl-language-server>`__.")
-    parser.add_argument(
-        "--version", "-V", action="version", version="%(prog)s " + version.__version__
-    )
-    parser.add_argument(
-        "--verbose", "-v", action="count", default=0, help="Show debug output"
-    )
-    parser.add_argument(
-        "--log-file", help="Redirect logs to the given file instead of stderr"
+    parser = ArgumentParser(
+        description="VHDL Language Protocol Server. Find info about clients in `ghdl/ghdl-language-server <https://github.com/ghdl/ghdl-language-server>`__."
     )
+    parser.add_argument("--version", "-V", action="version", version="%(prog)s " + version.__version__)
+    parser.add_argument("--verbose", "-v", action="count", default=0, help="Show debug output")
+    parser.add_argument("--log-file", help="Redirect logs to the given file instead of stderr")
     parser.add_argument("--trace-file", help="Save RPC data to FILE.in and FILE.out (overrides :envvar:`GHDL_LS_TRACE`)")
     parser.add_argument("--input", "-i", help="Read request from file")
     parser.add_argument(
diff --git a/pyGHDL/dom/DesignUnit.py b/pyGHDL/dom/DesignUnit.py
index 35ee8132..e9a8e7ab 100644
--- a/pyGHDL/dom/DesignUnit.py
+++ b/pyGHDL/dom/DesignUnit.py
@@ -39,7 +39,7 @@ This module contains all DOM classes for VHDL's design units (:class:`entity <En
 
 
 """
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyVHDLModel.VHDLModel import Entity        as VHDLModel_Entity
 from pyVHDLModel.VHDLModel import Architecture  as VHDLModel_Architecture
diff --git a/pyGHDL/dom/InterfaceItem.py b/pyGHDL/dom/InterfaceItem.py
index 94f43687..ec37d56a 100644
--- a/pyGHDL/dom/InterfaceItem.py
+++ b/pyGHDL/dom/InterfaceItem.py
@@ -31,7 +31,7 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
 # ============================================================================
 
-from pydecor                import export
+from pyTooling.Decorators   import export
 
 from pyVHDLModel.VHDLModel  import PortSignalInterfaceItem as VHDLModel_PortSignalInterfaceItem
 from pyVHDLModel.VHDLModel  import GenericConstantInterfaceItem as VHDLModel_GenericConstantInterfaceItem
diff --git a/pyGHDL/dom/Misc.py b/pyGHDL/dom/Misc.py
index bf8bc4be..90181e8a 100644
--- a/pyGHDL/dom/Misc.py
+++ b/pyGHDL/dom/Misc.py
@@ -38,7 +38,7 @@
 from pathlib import Path
 from typing  import Any
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyVHDLModel.VHDLModel  import Design        as VHDLModel_Design
 from pyVHDLModel.VHDLModel  import Library       as VHDLModel_Library
diff --git a/pyGHDL/dom/__init__.py b/pyGHDL/dom/__init__.py
index 39ba78ba..f3005bd9 100644
--- a/pyGHDL/dom/__init__.py
+++ b/pyGHDL/dom/__init__.py
@@ -31,6 +31,6 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
 # ============================================================================
 
-from pydecor            import export
+from pyTooling.Decorators import export
 
 __all__ = []
diff --git a/pyGHDL/libghdl/__init__.py b/pyGHDL/libghdl/__init__.py
index fc201e0e..fa717098 100644
--- a/pyGHDL/libghdl/__init__.py
+++ b/pyGHDL/libghdl/__init__.py
@@ -38,9 +38,11 @@ import sys
 from pathlib import Path
 from shutil import which
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl._types import Iir
+
+# from pyGHDL.libghdl._decorator import BindToLibGHDL
 from pyGHDL.libghdl.version import __version__
 
 
diff --git a/pyGHDL/libghdl/_decorator.py b/pyGHDL/libghdl/_decorator.py
index bc4b0df6..08680704 100644
--- a/pyGHDL/libghdl/_decorator.py
+++ b/pyGHDL/libghdl/_decorator.py
@@ -33,7 +33,7 @@
 
 from typing import Callable, List
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 
 @export
diff --git a/pyGHDL/libghdl/errorout.py b/pyGHDL/libghdl/errorout.py
index a038fa77..0ec338cf 100644
--- a/pyGHDL/libghdl/errorout.py
+++ b/pyGHDL/libghdl/errorout.py
@@ -1,7 +1,7 @@
 # Auto generated Python source file from Ada sources
 # Call 'make' in 'src/vhdl' to regenerate:
 #
-from pydecor import export
+from pyTooling.Decorators import export
 from pyGHDL.libghdl import libghdl
 
 @export
diff --git a/pyGHDL/libghdl/errorout_console.py b/pyGHDL/libghdl/errorout_console.py
index 3df82dd9..f4f2c3ed 100644
--- a/pyGHDL/libghdl/errorout_console.py
+++ b/pyGHDL/libghdl/errorout_console.py
@@ -32,7 +32,7 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
 # ============================================================================
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 
diff --git a/pyGHDL/libghdl/errorout_memory.py b/pyGHDL/libghdl/errorout_memory.py
index 26152a9d..fdbf0ed8 100644
--- a/pyGHDL/libghdl/errorout_memory.py
+++ b/pyGHDL/libghdl/errorout_memory.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_int8, c_int32, c_char_p, Structure
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 from pyGHDL.libghdl._types import ErrorIndex
diff --git a/pyGHDL/libghdl/files_map.py b/pyGHDL/libghdl/files_map.py
index 71ed32e9..06b5b626 100644
--- a/pyGHDL/libghdl/files_map.py
+++ b/pyGHDL/libghdl/files_map.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_void_p
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 from pyGHDL.libghdl._types import NameId, SourceFileEntry
diff --git a/pyGHDL/libghdl/files_map_editor.py b/pyGHDL/libghdl/files_map_editor.py
index b5c0184c..fd0cdbb8 100644
--- a/pyGHDL/libghdl/files_map_editor.py
+++ b/pyGHDL/libghdl/files_map_editor.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_int32, c_char_p, c_bool
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 from pyGHDL.libghdl._types import SourceFileEntry
diff --git a/pyGHDL/libghdl/libraries.py b/pyGHDL/libghdl/libraries.py
index 0c302ff4..41254213 100644
--- a/pyGHDL/libghdl/libraries.py
+++ b/pyGHDL/libghdl/libraries.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_int32
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 
diff --git a/pyGHDL/libghdl/name_table.py b/pyGHDL/libghdl/name_table.py
index 74bfbf11..099f9f37 100644
--- a/pyGHDL/libghdl/name_table.py
+++ b/pyGHDL/libghdl/name_table.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_char_p
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 from pyGHDL.libghdl._types import NameId
diff --git a/pyGHDL/libghdl/std_names.py b/pyGHDL/libghdl/std_names.py
index e716d86c..5667b746 100644
--- a/pyGHDL/libghdl/std_names.py
+++ b/pyGHDL/libghdl/std_names.py
@@ -1,7 +1,7 @@
 # Auto generated Python source file from Ada sources
 # Call 'make' in 'src/vhdl' to regenerate:
 #
-from pydecor import export
+from pyTooling.Decorators import export
 
 
 @export
diff --git a/pyGHDL/libghdl/utils.py b/pyGHDL/libghdl/utils.py
index b61386bb..b09e68e2 100644
--- a/pyGHDL/libghdl/utils.py
+++ b/pyGHDL/libghdl/utils.py
@@ -34,7 +34,7 @@
 from ctypes import byref
 from typing import List, Any, Generator
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl._decorator import EnumLookupTable
 from pyGHDL.libghdl._types import NameId
diff --git a/pyGHDL/libghdl/vhdl/elocations.py b/pyGHDL/libghdl/vhdl/elocations.py
index f6dbb262..18670635 100644
--- a/pyGHDL/libghdl/vhdl/elocations.py
+++ b/pyGHDL/libghdl/vhdl/elocations.py
@@ -1,7 +1,7 @@
 # Auto generated Python source file from Ada sources
 # Call 'make' in 'src/vhdl' to regenerate:
 #
-from pydecor import export
+from pyTooling.Decorators import export
 from pyGHDL.libghdl import libghdl
 
 Get_Start_Location = libghdl.vhdl__elocations__get_start_location
diff --git a/pyGHDL/libghdl/vhdl/flists.py b/pyGHDL/libghdl/vhdl/flists.py
index 9cb3e211..70387c7e 100644
--- a/pyGHDL/libghdl/vhdl/flists.py
+++ b/pyGHDL/libghdl/vhdl/flists.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_int32
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 
diff --git a/pyGHDL/libghdl/vhdl/formatters.py b/pyGHDL/libghdl/vhdl/formatters.py
index 621b0ea7..fbe961ab 100644
--- a/pyGHDL/libghdl/vhdl/formatters.py
+++ b/pyGHDL/libghdl/vhdl/formatters.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_int32, c_char_p
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 
diff --git a/pyGHDL/libghdl/vhdl/lists.py b/pyGHDL/libghdl/vhdl/lists.py
index 42a0ebf6..a1fafd70 100644
--- a/pyGHDL/libghdl/vhdl/lists.py
+++ b/pyGHDL/libghdl/vhdl/lists.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_int32, c_bool, POINTER, Structure
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 
diff --git a/pyGHDL/libghdl/vhdl/nodes.py b/pyGHDL/libghdl/vhdl/nodes.py
index 659813d1..919a4eab 100644
--- a/pyGHDL/libghdl/vhdl/nodes.py
+++ b/pyGHDL/libghdl/vhdl/nodes.py
@@ -1,7 +1,7 @@
 # Auto generated Python source file from Ada sources
 # Call 'make' in 'src/vhdl' to regenerate:
 #
-from pydecor import export
+from pyTooling.Decorators import export
 from pyGHDL.libghdl import libghdl
 
 Null_Iir = 0
diff --git a/pyGHDL/libghdl/vhdl/nodes_meta.py b/pyGHDL/libghdl/vhdl/nodes_meta.py
index 5ec7f950..f9059403 100644
--- a/pyGHDL/libghdl/vhdl/nodes_meta.py
+++ b/pyGHDL/libghdl/vhdl/nodes_meta.py
@@ -1,7 +1,7 @@
 # Auto generated Python source file from Ada sources
 # Call 'make' in 'src/vhdl' to regenerate:
 #
-from pydecor import export
+from pyTooling.Decorators import export
 from pyGHDL.libghdl import libghdl
 from pyGHDL.libghdl._types import IirKind
 
diff --git a/pyGHDL/libghdl/vhdl/nodes_utils.py b/pyGHDL/libghdl/vhdl/nodes_utils.py
index e840d524..b228df24 100644
--- a/pyGHDL/libghdl/vhdl/nodes_utils.py
+++ b/pyGHDL/libghdl/vhdl/nodes_utils.py
@@ -32,7 +32,7 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
 # ============================================================================
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl, Iir
 
diff --git a/pyGHDL/libghdl/vhdl/parse.py b/pyGHDL/libghdl/vhdl/parse.py
index a71b2aea..85c7276b 100644
--- a/pyGHDL/libghdl/vhdl/parse.py
+++ b/pyGHDL/libghdl/vhdl/parse.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_bool
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 
diff --git a/pyGHDL/libghdl/vhdl/scanner.py b/pyGHDL/libghdl/vhdl/scanner.py
index 36b52cb0..12d6f0e2 100644
--- a/pyGHDL/libghdl/vhdl/scanner.py
+++ b/pyGHDL/libghdl/vhdl/scanner.py
@@ -34,7 +34,7 @@
 
 from ctypes import c_int, c_bool
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 from pyGHDL.libghdl._types import SourceFileEntry, NameId
diff --git a/pyGHDL/libghdl/vhdl/sem.py b/pyGHDL/libghdl/vhdl/sem.py
index e1d8c7a0..f0731d6b 100644
--- a/pyGHDL/libghdl/vhdl/sem.py
+++ b/pyGHDL/libghdl/vhdl/sem.py
@@ -32,7 +32,7 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
 # ============================================================================
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 
diff --git a/pyGHDL/libghdl/vhdl/sem_lib.py b/pyGHDL/libghdl/vhdl/sem_lib.py
index 87a07f48..f00a88e5 100644
--- a/pyGHDL/libghdl/vhdl/sem_lib.py
+++ b/pyGHDL/libghdl/vhdl/sem_lib.py
@@ -32,7 +32,7 @@
 # SPDX-License-Identifier: GPL-2.0-or-later
 # ============================================================================
 
-from pydecor import export
+from pyTooling.Decorators import export
 
 from pyGHDL.libghdl import libghdl
 from pyGHDL.libghdl._types import SourceFileEntry
diff --git a/pyGHDL/libghdl/vhdl/tokens.py b/pyGHDL/libghdl/vhdl/tokens.py
index a846ea62..9acb8981 100644
--- a/pyGHDL/libghdl/vhdl/tokens.py
+++ b/pyGHDL/libghdl/vhdl/tokens.py
@@ -1,7 +1,7 @@
 # Auto generated Python source file from Ada sources
 # Call 'make' in 'src/vhdl' to regenerate:
 #
-from pydecor import export
+from pyTooling.Decorators import export
 
 
 @export
diff --git a/scripts/pnodespy.py b/scripts/pnodespy.py
index 3f287580..718aba7b 100755
--- a/scripts/pnodespy.py
+++ b/scripts/pnodespy.py
@@ -32,11 +32,14 @@ def print_enum(name, vals):
 
 def print_file_header():
     print(dedent("""\
-        # Auto generated Python source file from Ada sources
-        # Call 'make' in 'src/vhdl' to regenerate:
-        #
-        from pydecor import export
-    """), end='')
+			# Auto generated Python source file from Ada sources
+			# Call 'make' in 'src/vhdl' to regenerate:
+			#
+        """) + "{sysImports}from pyTooling.Decorators import export\n{moduleImports}".format(
+            sysImports = "from enum import IntEnum, unique\n" if includeIntEnumUnique else "",
+            moduleImports = "\nfrom pyGHDL.libghdl._decorator import BindToLibGHDL\n" if includeBindToLibGHDL else "",
+        )
+    )
 
 
 def do_class_kinds():
-- 
2.34.1

